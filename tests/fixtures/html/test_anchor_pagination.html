<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>锚定翻页综合测试靶场</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            background: #f5f6fa;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 16px 24px;
        }

        .header h1 {
            font-size: 18px;
            font-weight: 600;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .info-panel {
            background: #e8f4fd;
            border: 1px solid #2196f3;
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            font-size: 13px;
            color: #1565c0;
        }

        .stats-row {
            display: flex;
            gap: 15px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            flex: 1;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: #2196f3;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .card-header {
            padding: 14px 20px;
            border-bottom: 1px solid #e8e8e8;
        }

        .card-title {
            font-size: 15px;
            font-weight: 600;
            color: #1a1a1a;
        }

        .card-body {
            padding: 0;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .data-table th {
            background: #fafafa;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e8e8e8;
        }

        .data-table td {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .data-table input {
            width: 100%;
            min-width: 80px;
            padding: 6px 10px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 12px;
        }

        .data-table input:focus {
            border-color: #2196f3;
            outline: none;
        }

        .data-table input[readonly] {
            background: #f5f5f5;
            color: #333;
        }

        .anchor-col {
            background: #e3f2fd;
            font-weight: 600;
            color: #1565c0;
        }

        .anchor-header {
            background: #2196f3 !important;
            color: white !important;
        }

        .row-num {
            font-weight: 600;
            color: #999;
            width: 40px;
            text-align: center;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border-top: 1px solid #e8e8e8;
        }

        .page-btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .page-btn:hover:not(:disabled) {
            border-color: #2196f3;
            color: #2196f3;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .fill-col {
            background: #fff8e1;
        }

        .next-btn {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .next-btn:hover:not(:disabled) {
            background: #43a047;
        }
    </style>
</head>

<body>
    <header class="header">
        <h1>锚定翻页综合测试靶场（6页版 - 第6页无匹配数据）</h1>
    </header>

    <div class="container">
        <div class="info-panel">
            <strong>测试说明：</strong>共6页，前5页各4条匹配数据(MED-001~MED-020)，<b>第6页4条无匹配数据(EMPTY-001~004)</b>。
            <br>Excel有300行，仅20行匹配。第6页点继续应提示"当前页没有匹配的数据"。
        </div>

        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-label">当前页</div>
                <div class="stat-value" id="current-page">1</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">总页数</div>
                <div class="stat-value">6</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">本页记录</div>
                <div class="stat-value">4</div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><span class="card-title">耗材消耗登记表</span></div>
            <div class="card-body">
                <table class="data-table" id="data-table">
                    <thead>
                        <tr>
                            <th class="row-num">#</th>
                            <th class="anchor-header">HIS编码 (锚点)</th>
                            <th>耗材名称</th>
                            <th>规格型号</th>
                            <th class="fill-col">消耗数量</th>
                            <th class="fill-col">领用科室</th>
                            <th class="fill-col">备注</th>
                        </tr>
                    </thead>
                    <tbody id="table-body"></tbody>
                </table>
            </div>
            <div class="pagination">
                <button class="page-btn" id="prev-btn" onclick="changePage(-1)" disabled>上一页</button>
                <span style="font-size:13px;color:#666;">第 <span id="page-num">1</span> / 6 页</span>
                <button class="page-btn next-btn" id="next-page-btn" onclick="changePage(1)">下一页</button>
            </div>
        </div>
    </div>

    <script>
        // 6页数据 (前5页有匹配数据，第6页无匹配)
        const allData = [
            // 第1-5页：有匹配的MED编码
            { his_code: 'MED-001', name: '一次性注射器', spec: '5ml', page: 1 },
            { his_code: 'MED-002', name: '医用纱布', spec: '10x10cm', page: 1 },
            { his_code: 'MED-003', name: '静脉留置针', spec: '24G', page: 1 },
            { his_code: 'MED-004', name: '吸痰管', spec: '12Fr', page: 1 },
            { his_code: 'MED-005', name: '输液器', spec: '标准', page: 2 },
            { his_code: 'MED-006', name: '医用胶带', spec: '2.5cm', page: 2 },
            { his_code: 'MED-007', name: '导尿管', spec: '16Fr', page: 2 },
            { his_code: 'MED-008', name: '心电电极片', spec: '成人', page: 2 },
            { his_code: 'MED-009', name: '氧气面罩', spec: '成人', page: 3 },
            { his_code: 'MED-010', name: '引流袋', spec: '2000ml', page: 3 },
            { his_code: 'MED-011', name: '无菌手套', spec: '7.5号', page: 3 },
            { his_code: 'MED-012', name: '棉签', spec: '无菌', page: 3 },
            { his_code: 'MED-013', name: '碘伏', spec: '500ml', page: 4 },
            { his_code: 'MED-014', name: '创可贴', spec: '标准', page: 4 },
            { his_code: 'MED-015', name: '压脉带', spec: '标准', page: 4 },
            { his_code: 'MED-016', name: '采血管', spec: '5ml', page: 4 },
            { his_code: 'MED-017', name: '口罩', spec: 'N95', page: 5 },
            { his_code: 'MED-018', name: '防护服', spec: 'L', page: 5 },
            { his_code: 'MED-019', name: '护目镜', spec: '标准', page: 5 },
            { his_code: 'MED-020', name: '鞋套', spec: '一次性', page: 5 },
            // 第6页：无匹配数据（Excel中没有这些编码）
            { his_code: 'EMPTY-001', name: '测试耗材A', spec: '无', page: 6 },
            { his_code: 'EMPTY-002', name: '测试耗材B', spec: '无', page: 6 },
            { his_code: 'EMPTY-003', name: '测试耗材C', spec: '无', page: 6 },
            { his_code: 'EMPTY-004', name: '测试耗材D', spec: '无', page: 6 },
        ];

        let currentPage = 1;
        const totalPages = 6;

        function renderTable() {
            const tbody = document.getElementById('table-body');
            const pageData = allData.filter(item => item.page === currentPage);

            tbody.innerHTML = pageData.map((item, idx) => {
                const globalIdx = (currentPage - 1) * 4 + idx + 1;
                return `
                <tr>
                    <td class="row-num">${globalIdx}</td>
                    <td class="anchor-col"><input type="text" value="${item.his_code}" readonly></td>
                    <td>${item.name}</td>
                    <td>${item.spec}</td>
                    <td class="fill-col"><input type="number" placeholder="数量"></td>
                    <td class="fill-col"><input type="text" placeholder="科室"></td>
                    <td class="fill-col"><input type="text" placeholder="备注"></td>
                </tr>
            `}).join('');

            document.getElementById('page-num').textContent = currentPage;
            document.getElementById('current-page').textContent = currentPage;
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-page-btn').disabled = currentPage === totalPages;
        }

        function changePage(delta) {
            const newPage = currentPage + delta;
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderTable();
            }
        }

        renderTable();
    </script>
</body>

</html>